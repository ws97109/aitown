# 問卷系統使用指南

## 系統功能概覽

您的問卷系統已經完成全面升級，現在具備以下強大功能：

### ✨ 核心功能

1. **美觀的現代化UI** - 漸變色設計、流暢動畫、響應式佈局
2. **AI自動填寫** - 9個AI居民根據性格特徵智能填寫問卷
3. **數據視覺化分析** - 使用Chart.js提供豐富的圖表展示
4. **多種匯出格式** - 支援CSV、JSON、Excel格式
5. **詳細統計分析** - 單選題、多選題、評分題、文字題的深度分析

---

## 快速開始

### 1. 啟動Web服務器

```bash
python replay.py
```

服務器將在 http://localhost:5001 啟動

### 2. 訪問問卷系統

在瀏覽器中訪問：
```
http://localhost:5001/surveys
```

---

## 收入調查問卷

我已經為您創建了一個完整的「社區居民收入與生活滿意度調查」問卷，包含15個精心設計的問題：

### 問卷內容

1. **基本信息** - 年齡段、職業類型
2. **收入狀況** - 月收入範圍、收入來源
3. **支出分析** - 主要支出類型、儲蓄習慣
4. **消費觀念** - 消費態度、理財方式
5. **滿意度評估** - 收入滿意度、經濟壓力、生活滿意度
6. **未來規劃** - 支出計劃、收入目標
7. **開放問題** - 收入與幸福感、建議期待

### 查看問卷結果

問卷ID：`65e06e6a-51fa-4a28-9f81-33794c59f486`

**訪問連結：**

- 問卷詳情：http://localhost:5001/surveys/65e06e6a-51fa-4a28-9f81-33794c59f486
- 視覺化分析：http://localhost:5001/surveys/65e06e6a-51fa-4a28-9f81-33794c59f486/analytics

---

## 視覺化分析功能

### 統計摘要卡片

頁面頂部顯示4個精美的統計卡片：
- 總回應數
- 已完成數量
- 完成率
- 問題總數

### 不同問題類型的視覺化

#### 1. 單選題
- **圓餅圖** - 展示選項分布比例
- **柱狀圖** - 顯示各選項票數
- **數據表格** - 詳細的票數和百分比，配有進度條

#### 2. 多選題
- **橫向柱狀圖** - 展示各選項被選擇的頻率
- **數據表格** - 選擇次數和選擇率統計

#### 3. 評分題
- **分數分布圖** - 1-5分的評分分布
- **平均分展示** - 大字體顯示平均評分
- **星級評價** - 直觀的星星圖示
- **統計信息** - 最高分、最低分、總回應數

#### 4. 文字題
- **高頻詞彙分析** - 柱狀圖展示最常出現的詞彙
- **詞彙雲** - 標籤雲形式展示關鍵詞
- **統計摘要** - 回應數量、平均長度

---

## AI居民填寫情況

所有9位AI居民已完成問卷填寫：

1. ✓ 魏祺紘（18歲，大一新生）
2. ✓ 游庭瑄（45歲，教授）
3. ✓ 李昇峰（50歲，藥店老闆）
4. ✓ 蔡宗陞（28歲，咖啡店老闆）
5. ✓ 陳冠佑（35歲，酒吧老闆）
6. ✓ 鄭傑丞（21歲，學生）
7. ✓ 莊于萱（19歲，學生）
8. ✓ 施宇鴻（22歲，學生）
9. ✓ 盧品蓉（20歲，學生）

每位AI居民的回答都基於其：
- 年齡和職業特徵
- 性格特質
- 興趣愛好
- 生活型態

---

## 數據匯出

### 支援的格式

1. **CSV格式** - 適合Excel分析
2. **JSON格式** - 適合程式化處理
3. **Excel格式** - 包含統計摘要和詳細數據

### 匯出方式

- 在問卷列表頁面點擊「匯出」下拉選單
- 在問卷詳情頁面點擊匯出按鈕
- 在視覺化分析頁面底部的數據匯出區

---

## 創建新問卷

### 方式一：使用腳本創建（推薦）

參考 `create_income_survey.py` 腳本，您可以：

```python
from survey_system import Survey, SurveyManager

# 創建問卷
survey = Survey(title="問卷標題", description="問卷描述")

# 添加問題
survey.add_question(
    question_type="single_choice",  # 或 multiple_choice, rating, text
    question_text="問題內容",
    options=["選項1", "選項2"],  # 選擇題需要
    required=True
)

# 儲存問卷
manager = SurveyManager()
manager.save_survey(survey)
```

### 方式二：Web界面創建

1. 訪問 http://localhost:5001/surveys/create
2. 填寫問卷標題和描述
3. 動態添加問題
4. 點擊提交創建問卷

---

## 系統架構

### 前端增強
- `frontend/static/css/survey-enhanced.css` - 增強的CSS樣式
- `frontend/templates/surveys/analytics.html` - 視覺化分析頁面
- Chart.js 3.9.1 - 圖表庫

### 後端路由
- `/surveys` - 問卷列表
- `/surveys/<id>` - 問卷詳情
- `/surveys/<id>/analytics` - 視覺化分析
- `/surveys/<id>/fill` - AI填寫（POST）
- `/surveys/<id>/export` - 數據匯出

### 數據模型
- `Survey` - 問卷模型
- `SurveyResponse` - 回應模型
- `SurveyManager` - 管理器
- `AIResidentSurveyFiller` - AI填寫器

---

## 設計特色

### 🎨 UI/UX設計

1. **漸變色主題** - 紫色到藍色的現代漸變
2. **流暢動畫** - 淡入、懸停效果、進度條動畫
3. **卡片式佈局** - 清晰的視覺層次
4. **響應式設計** - 適配各種螢幕尺寸

### 📊 數據視覺化

1. **多圖表類型** - 圓餅圖、柱狀圖、橫向柱狀圖
2. **互動式圖表** - 懸停顯示詳細信息
3. **顏色編碼** - 直觀的數據呈現
4. **進度條** - 動態展示百分比

### 🤖 AI智能填寫

1. **性格驅動** - 基於AI居民性格特徵
2. **一致性保證** - 使用哈希確保答案穩定
3. **多樣化回答** - 不同居民有不同的回答傾向
4. **文字生成** - 智能生成符合角色的文字回應

---

## 故障排除

### 問題1：無法訪問視覺化頁面

**解決方案：**
- 確保問卷已有回應數據
- 檢查網絡連接
- 查看瀏覽器控制台錯誤信息

### 問題2：圖表不顯示

**解決方案：**
- 確保網絡可以訪問CDN（Chart.js）
- 清除瀏覽器緩存
- 檢查JavaScript控制台錯誤

### 問題3：AI填寫失敗

**解決方案：**
- 檢查問卷格式是否正確
- 確保所有必填項都有有效選項
- 查看終端錯誤信息

---

## 進階使用

### 自定義AI填寫邏輯

編輯 `survey_system/ai_filler.py` 中的方法：
- `_generate_single_choice_answer()` - 單選題邏輯
- `_generate_multiple_choice_answer()` - 多選題邏輯
- `_generate_rating_answer()` - 評分題邏輯
- `_generate_text_answer()` - 文字題邏輯

### 自定義視覺化

編輯 `frontend/templates/surveys/analytics.html`：
- 修改圖表類型
- 調整顏色方案
- 添加新的統計指標

### 自定義樣式

編輯 `frontend/static/css/survey-enhanced.css`：
- 修改主題顏色（`:root` 變數）
- 調整動畫效果
- 自定義卡片樣式

---

## 技術規格

### 前端技術
- Bootstrap 4
- Font Awesome 5
- Chart.js 3.9.1
- jQuery
- CSS3 動畫

### 後端技術
- Flask 2.x
- Python 3.8+

### 數據存儲
- JSON文件系統
- 問卷：`survey_system/data/surveys/`
- 回應：`survey_system/data/responses/`
- 匯出：`survey_system/data/exports/`

---

## 未來擴展建議

1. **即時更新** - WebSocket實現即時數據更新
2. **更多圖表** - 雷達圖、熱力圖、散點圖
3. **數據對比** - 多個問卷的橫向對比
4. **AI生成問卷** - 使用LLM自動生成問卷問題
5. **導出報告** - 生成PDF格式的分析報告
6. **數據庫支持** - 遷移到PostgreSQL或MongoDB
7. **用戶權限** - 添加用戶認證和權限管理

---

## 聯絡與支持

如有任何問題或建議，請參考：
- 專案文檔：`CLAUDE.md`
- 問卷系統測試：`survey_system/test_survey.py`

祝您使用愉快！ 🎉
